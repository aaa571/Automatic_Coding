Currently, only Japanese is supported.

PDF版のREADME（コードとともにアップロードされています）の参照を推奨します。

（以下、PDF内容）

＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿

※このプログラムはVSCodeとGitHub Copilotを使用します。学生は申請後、無料で使用可能です。

＜このプログラムについて＞
このプログラムは、エディタであるVSCodeとLLMであるGitHub Copilotを用いて、コード生成から、バグ修正までを自動で行うプログラムです。
バッチファイルを起動させ、自然言語で要求（プロンプト）を入力すると、コードを生成開始します。対応言語は日本語とPythonです。
このプログラムでは、生成したコード内に使用できないモジュールがあった時、そのパッケージを自動でインストールします。ただし、pipのパッケージ名とモジュール名が違うものは手動でインストールする必要があります。

< 設定方法 >

１．配置
このプログラム（Automatic_code_generationフォルダ）はCドライブ直下に配置してください。
その他の場所に配置した場合、Settings.pyからパス（program_path）を変更してください。
　初期設定："C:\Automatic_code_generation\program"

（１．２．仮想環境設定）
動作確認済みの環境は、Python3.12.3です。
Automatic_code_generation \programフォルダをVSCodeで開いて、右下のインタプリタからバージョンを設定してください。
 
 
図１　インタプリタ設定

　その後、Automatic_code_generation \programフォルダをVSCodeで開きなおしてください。ターミナル（Ctrl+@）にpython --versionと入力して、右下のインタプリタに表示されているバージョンと一致しているか確認してください。ターミナルとインタプリタのPythonバージョンが一致しない場合、不具合が出ることがあります。一致しない場合は、右上の実行ボタンを押して、再度python --versionで確認してください。

２．モジュールインストール
pip install -r requirements.txtで必要なモジュールをインストールしてください。

３．使用環境の設定
　バッファイルmain.batを開き、図の8行目「Study」に当たる部分を、使いたい仮想環境の名称に変更してください。デフォルトでは、condaによる仮想環境を使用しています。
 
図２　仮想環境名の変更

４．ディスプレイ設定
Windows画面解像度：1920×1080、画面拡大率：125% 推奨です。値が異なる場合は、PCのディスプレイ設定から解像度と拡大率を変更してください。
このプログラムは、画面解像度：1920×1080、画面拡大率100%、125%に対して対応可能なことを確認しています。（150%以上は不具合が確認されているため非推奨。また、画面解像度変更も非推奨。）拡大率を125%にしたくない場合や上手くプログラムが動かない場合は、pdf末尾の座標設定に従って、プログラムに使用する座標とプログラムに使用する画像を修正してください。

５．環境変数設定
PCウィンドウ下部のタスクバー検索欄から「システム環境変数の編集」を検索し、開きます。　
　「環境変数」を開き、「Path」をクリックした後、「編集」を開き、「新規」をクリックします。
　「C:\Automatic_code_generation\program」を入力して、すべてのウィンドウで「OK」を押します。
　これでパスが通ったため、Windows + R でバッチファイル実行のショートカットが可能になります。


< 使用方法 >
1.	コードを生成したいPythonファイル（以降「コード生成先ファイル」と呼ぶ）をVSCodeで開きます。VSCodeウィンドウは全画面で表示してください。また、ターミナル（Ctrl+@）も開いておいてください。　※コード生成先の環境は、このプログラムの環境（推奨：Python3.12.3）に合わせる必要はありません。

2.	Windows + Rでバッチを呼び出し、「main.bat」と入力し、Enterを押します。
 
図３　実行ショートカット

3.	コマンドプロンプトが開くので、必要ならばcキーを押してプロパティ(数値等)を変更します。通常は変更の必要がないのでEnterを押して次に進んでください。プロパティ変更する場合には、Settings.pyという設定ファイルが開くので、それを編集し、保存（Ctrl+S）してください。バッチが再起動します。※バッチを再起動させないと変更が反映されません。

4.	コード生成先のフォルダパスを設定します。変更がある場合はcキーを、ない場合はEnterを押してください。VS Codeのターミナルに表示されているパス（図4の青くなっている部分）をコピー＆ペーストしてください。※”PS”や空白、”>”は含めないように注意してください。指定の際、「’」や「”」をつける必要はありません。変更した場合、その設定が保存され、次回にも引き継がれます。

 
図４　ディレクトリパスの例


5.	要求（プロンプト）を入力してEnterを押すと、プログラムが開始します。　※ 図５のように、VS Codeを全画面で開き、バッチのウィンドウ（コマンドプロンプト）を左側に寄せた状態で開始してください。緑枠で示すように、右端のスペースを空けておいてください。
生成が完了するまでマウスやキーボードを操作しないようにしてください。
プログラムを途中で停止・再起動させる場合は、ESCキーを押してください。
※プログラムを開きながらWordなど他のファイルの操作をしていた場合、ESCキーが反応しなることがあります。その場合、マウスポインタを画面の左上角に移動させると停止します。

 
図5　プログラム開始時の画面

6.	プログラムが終了するとウィンドウが開きます。このウィンドウは、Enter / Spaceキーで閉じることが出きます。反応しない場合は、ウィンドウをクリックしてからEnter / Space キーを押すか、直接×ボタンを押してください。　※ このウィンドウを閉じないとプログラムが終了しないので注意してください。
 
図７．生成完了時のウィンドウ



（座標設定）--------
Settings.pyを開いてください。画面拡大率100% のときは、①画面拡大率の値を修正し、②座標を以下の値に修正して試してください。（画面拡大率125%、または、画面拡大率100%で下記設定後にうまく動作しない場合は、座標修正を参照してください。）

①	screen_rateの値を100に変更してください。（初期値：125（画面拡大率125%））
 

②	各画面解像度と拡大率における座標の設定例です。以下のように指定してください。（実際にはより正確な値へ修正する必要があるかもしれません。）

解像度：1920×1080、拡大率：100% のとき
x_blanc_space = 1750
y_blanc_space = 400
x_execute = 1830
y_execute = 50
x_terminal = 1600
y_terminal = 1003

解像度：1920×1080、拡大率：125% のとき（初期設定）
x_blanc_space = 1800
y_blanc_space = 400
x_execute = 1805
y_execute = 64
x_terminal = 1200
y_terminal = 975



（座標修正）
上記を試したり、画面拡大率125%にもかかわらず、プログラムが上手く動かない場合は以下に従って修正してください。
Tkinter.pyを開いて、PCの画面拡大率を指定してください。
 
図８．Tkinterの設定

　　
Tkinter.pyを実行し、表示された座標に従って、Settings.pyの以下6箇所を修正してください。（詳細は図９を見てください。）

x_blanc_space / y_blanc_space	コードを記述するスペース内の座標です。
バッチファイルを実行した後に、プログラムがVSCodeのウィンドウをクリックできるように、右側のスペースを指定してください（図３）。
x_execute / y_execute	VSCode右上にある実行ボタンの座標を指定してください。
x_terminal / y_terminal	ターミナルの右下を指定してください。y座標は、ターミナル内のできるだけ下の部分を指定してください。

 
図９．各座標指定

 
図１０．blanc_spaceの（バッチを開いたときに干渉しない場所の）座標指定

修正後、再度実行し、正常に動作するか確認してください。
